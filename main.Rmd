```{r Preparation of the environment, message=FALSE, warning=FALSE}
cat("\014")
rm(list = ls())
library(dplyr)
library(ggplot2)
library(kohonen)
```

```{r Loading the data and their preprocessing}

dataset <- read.csv("dataset.txt", 
                        header = TRUE, 
                        sep = ",",
                        stringsAsFactors = FALSE)

for (i in 1:5){
  dataset[,i] <- as.numeric(dataset[,i])
}

Malignant <- dataset[dataset$Severity == 1,]
Benign <- dataset[dataset$Severity == 0,]

for (i in 1:5){
  Malignant[is.na(Malignant[,i]),i]<-median(Malignant[,i], na.rm = T)
  Benign[is.na(Benign[,i]),i] <- median(Benign[,i], na.rm = T)
}

Benign <- Benign[!(Benign$BI.RADS < 1 | Benign$BI.RADS > 5  | Benign$Shape < 1  | Benign$Shape > 4
                  | Benign$Margin < 1  | Benign$Margin > 5  | Benign$Density < 1  | Benign$Density > 4),]
Malignant <- Malignant[!(Malignant$BI.RADS < 1 | Malignant$BI.RADS > 5  | Malignant$Shape < 1  | Malignant$Shape > 4
                  | Malignant$Margin < 1  | Malignant$Margin > 5  | Malignant$Density < 1  | Malignant$Density > 4),]

numberOfMalignant <- nrow(Malignant)
numberOfBenign <- nrow(Benign)

traingingData <- dataset[1:round(nrow(dataset)/2),]
testingData <- dataset[(round(nrow(dataset)/2)+1):nrow(dataset),]
dataset <- dataset[order(dataset$Severity, decreasing = TRUE),]

```

```{r Histograms}
ggplot(Malignant,aes(BI.RADS)) + geom_histogram(bins = 4, alpha = 0.5, fill = 'red') + 
  geom_histogram(data = Benign,mapping = aes(BI.RADS),bins = 4, alpha = 0.5, fill = 'blue')

hist(Malignant$BI.RADS, breaks = 2:5, col=rgb(1,0,0,0.5), xlab="values of BI-RADS, from 1 to 5", 
     ylab="counts", main="Histogram of BI-RADS" )

hist(Benign$BI.RADS, breaks = 2:5, col=rgb(0,0,1,0.5), add=T)



legend("topright", legend=c("Malignant","Benign"), col=c(rgb(1,0,0,0.5), 
     rgb(0,0,1,0.5)), pt.cex=1, pch=15)

hist(Malignant$Age, xlim=c(min(Malignant$Age),max(Malignant$Age)), col=rgb(1,0,0,0.5), xlab="values of Age", 
     ylab="counts", main="Histogram of Age" )

hist(Benign$Age, xlim=c(min(Benign$Age),max(Benign$Age)), col=rgb(0,0,1,0.5), add=T)

legend("topright", legend=c("Malignant","Benign"), col=c(rgb(1,0,0,0.5), 
     rgb(0,0,1,0.5)), pt.cex=1, pch=15)

hist(Malignant$Shape, xlim=c(min(Benign$Shape),max(Benign$Shape)), col=rgb(1,0,0,0.5), xlab="values of Shape, from 1 to 4", 
     ylab="counts", main="Histogram of Shape" )

hist(Benign$Shape, xlim=c(min(Benign$Shape),max(Benign$Shape)), col=rgb(0,0,1,0.5), add=T)

legend("topright", legend=c("Malignant","Benign"), col=c(rgb(1,0,0,0.5), 
     rgb(0,0,1,0.5)), pt.cex=1, pch=15)

hist(Malignant$Margin, xlim=c(min(Benign$Margin),max(Benign$Margin)), col=rgb(1,0,0,0.5), xlab="values of Margin, from 1 to 5", 
     ylab="counts", main="Histogram of Margin" )

hist(Benign$Margin, xlim=c(min(Benign$Margin),max(Benign$Margin)), col=rgb(0,0,1,0.5), add=T)

legend("topright", legend=c("Malignant","Benign"), col=c(rgb(1,0,0,0.5), 
     rgb(0,0,1,0.5)), pt.cex=1, pch=15)

hist(Malignant$Density, xlim=c(min(Benign$Density),max(Benign$Density)), col=rgb(1,0,0,0.5), xlab="values of Density, from 1 to 5", 
     ylab="counts", main="Histogram of Density" )

hist(Benign$Density, xlim=c(min(Benign$Density),max(Benign$Density)), col=rgb(0,0,1,0.5), add=T)

legend("topright", legend=c("Malignant","Benign"), col=c(rgb(1,0,0,0.5), 
     rgb(0,0,1,0.5)), pt.cex=1, pch=15)

hist(dataset$Severity, breaks = c(-0.5,0.5,1.5), xlim=c(-0.5,1.5), col=c(rgb(0,0,1,0.5), rgb(1,0,0,0.5)), xlab="values of Severity, from 0 to 1", 
     ylab="counts", main="Histogram of Severity" )

legend("topright", legend=c("Malignant","Benign"), col=c(rgb(1,0,0,0.5), 
     rgb(0,0,1,0.5)), pt.cex=1, pch=15)

```

```{r Parameter setting for SOM}

```

```{r SOM network learning process}

```

```{r SOM network learning results}
 
```

```{r SOM network test - on unknown data (error after learning)}

```

```{r Test results for SOM + SOM operating and network sensitivity}

```
