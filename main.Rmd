```{r Preparation of the environment, message=FALSE, warning=FALSE}
cat("\014")
rm(list = ls())
library(dplyr)
library(ggplot2)
library(kohonen)
```

```{r Loading the data and their preprocessing}

dataset <- read.csv("dataset.txt", 
                        header = TRUE, 
                        sep = ",",
                        stringsAsFactors = FALSE)

for (i in 1:5){
  dataset[,i] <- as.numeric(dataset[,i])
}

Malignant <- dataset[dataset$Severity == 1,]
Benign <- dataset[dataset$Severity == 0,]

for (i in 1:5){
  Malignant[is.na(Malignant[,i]),i]<-median(Malignant[,i], na.rm = T)
  Benign[is.na(Benign[,i]),i] <- median(Benign[,i], na.rm = T)
}

Benign <- Benign[!(Benign$BI.RADS < 1 | Benign$BI.RADS > 5  | Benign$Shape < 1  | Benign$Shape > 4
                  | Benign$Margin < 1  | Benign$Margin > 5  | Benign$Density < 1  | Benign$Density > 4),]
Malignant <- Malignant[!(Malignant$BI.RADS < 1 | Malignant$BI.RADS > 5  | Malignant$Shape < 1  | Malignant$Shape > 4
                  | Malignant$Margin < 1  | Malignant$Margin > 5  | Malignant$Density < 1  | Malignant$Density > 4),]

numberOfMalignant <- nrow(Malignant)
numberOfBenign <- nrow(Benign)

traingingData <- dataset[1:round(nrow(dataset)/2),]
testingData <- dataset[(round(nrow(dataset)/2)+1):nrow(dataset),]
dataset <- dataset[order(dataset$Severity, decreasing = TRUE),]

```

```{r Histograms}

ggplot(Malignant,aes(BI.RADS)) + geom_histogram(bins = 4, alpha = 0.5, fill = 'red') + 
  geom_histogram(data = Benign,mapping = aes(BI.RADS),bins = 4, alpha = 0.5, fill = 'blue') +
  ggtitle("Histogram of BI.RADS values") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(name="BI.RADS values",values=c("blue","red"),labels=c("Malignant","Benign"))

ggplot(Malignant,aes(Age)) + geom_histogram(bins = 4, alpha = 0.5, fill = 'red') + 
  geom_histogram(data = Benign,mapping = aes(Age),bins = 4, alpha = 0.5, fill = 'blue') +
  ggtitle("Histogram of Age values") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(name="Age values",values=c("blue","red"),labels=c("Malignant","Benign"))

ggplot(Malignant,aes(Shape)) + geom_histogram(bins = 4, alpha = 0.5, fill = 'red') + 
  geom_histogram(data = Benign,mapping = aes(Shape),bins = 4, alpha = 0.5, fill = 'blue') +
  ggtitle("Histogram of Shape values") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(name="Shape values",values=c("blue","red"),labels=c("Malignant","Benign"))

ggplot(Malignant,aes(Margin)) + geom_histogram(bins = 4, alpha = 0.5, fill = 'red') + 
  geom_histogram(data = Benign,mapping = aes(Margin),bins = 4, alpha = 0.5, fill = 'blue') +
  ggtitle("Histogram of Margin values") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(name="Margin values",values=c("blue","red"),labels=c("Malignant","Benign"))

ggplot(Malignant,aes(Density)) + geom_histogram(bins = 4, alpha = 0.5, fill = 'red') + 
  geom_histogram(data = Benign,mapping = aes(Density),bins = 4, alpha = 0.5, fill = 'blue') +
  ggtitle("Histogram of Density values") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(name="Density values",values=c("blue","red"),labels=c("Malignant","Benign"))

ggplot(Malignant,aes(Severity)) + geom_histogram(bins = 2, alpha = 0.5, fill = 'red') + 
  geom_histogram(data = Benign,mapping = aes(Severity),bins = 2, alpha = 0.5, fill = 'blue') +
  ggtitle("Histogram of Severity values") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(name="Severity values",values=c("blue","red"),labels=c("Malignant","Benign"))

```

```{r Parameter setting for SOM}

```

```{r SOM network learning process}

```

```{r SOM network learning results}
 
```

```{r SOM network test - on unknown data (error after learning)}

```

```{r Test results for SOM + SOM operating and network sensitivity}

```
